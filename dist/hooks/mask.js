"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,a,s){void 0===s&&(s=a),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,s){void 0===s&&(s=a),e[s]=t[a]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.MaskStyle=exports.Mask=exports.maskClassName=void 0;const string_utils_1=__importDefault(require("@bizhermit/basic-utils/dist/string-utils")),react_1=__importStar(require("react")),react_dom_1=__importDefault(require("react-dom")),style_1=__importStar(require("../layouts/style"));exports.maskClassName="bh-msk";const Mask=e=>{const t=(0,react_1.useRef)();return(0,react_1.useEffect)((()=>{t.current.focus()}),[]),react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{ref:t,className:exports.maskClassName,tabIndex:0,onKeyDown:e=>{e.stopPropagation(),e.preventDefault()},onBlur:e=>{null!=e.relatedTarget&&e.relatedTarget.className.indexOf(exports.maskClassName)>=0||t.current.focus()},"data-image":e.image,style:{zIndex:e.zIndex}},react_1.default.createElement("div",{className:`${exports.maskClassName}-wall`}),react_1.default.createElement("div",{className:`${exports.maskClassName}-item1`}),react_1.default.createElement("div",{className:`${exports.maskClassName}-item2`}),string_utils_1.default.isEmpty(e.text)?react_1.default.createElement(react_1.default.Fragment,null):react_1.default.createElement("div",{className:`${exports.maskClassName}-text`},e.text)),exports.MaskStyle)};exports.Mask=Mask,exports.MaskStyle=react_1.default.createElement(style_1.default,{id:exports.maskClassName,notDepsColor:!0,css:({design:e})=>`\n.${exports.maskClassName} {\n  box-sizing: border-box !important;\n  position: absolute !important;\n  top: 0px !important;\n  left: 0px !important;\n  height: 100% !important;\n  width: 100% !important;\n  min-height: 100% !important;\n  min-width: 100% !important;\n  max-height: 100% !important;\n  max-width: 100% !important;\n  outline: none;\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n  z-index: 2000000000;\n}\n.${exports.maskClassName}-wall {\n  z-index: 0;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100%;\n  background: ${style_1.CssVar.mask.bg};\n}\n.${exports.maskClassName}-item1,\n.${exports.maskClassName}-item2 {\n  box-sizing: border-box;\n  position: relative;\n  z-index: 1;\n}\n.${exports.maskClassName}-item1::before,\n.${exports.maskClassName}-item1::after,\n.${exports.maskClassName}-item2::before,\n.${exports.maskClassName}-item2::after {\n  box-sizing: border-box;\n  position: absolute;\n  cursor: inherit;\n  content: "";\n}\n.${exports.maskClassName}-text {\n  box-sizing: border-box;\n  position: relative;\n  z-index: 2;\n  cursor: inherit;\n  color: ${style_1.CssVar.fc};\n}\n.${exports.maskClassName}[data-image="spin-circle"] {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: center;\n  align-items: center;\n}\n.${exports.maskClassName}[data-image="spin-circle"] .${exports.maskClassName}-item1 {\n  height: 50px;\n  width: 50px;\n  filter: drop-shadow(5px 5px 3px ${style_1.CssVar.shadow.dc});\n}\n.${exports.maskClassName}[data-image="spin-circle"] .${exports.maskClassName}-item1::before,\n.${exports.maskClassName}[data-image="spin-circle"] .${exports.maskClassName}-item1::after {\n  height: 100%;\n  width: 100%;\n  border-radius: 50%;\n}\n.${exports.maskClassName}[data-image="spin-circle"] .${exports.maskClassName}-item1::before {\n  border: 8px solid ${style_1.CssVar.mask.img_bgc};\n}\n.${exports.maskClassName}[data-image="spin-circle"] .${exports.maskClassName}-item1::after {\n  border-width: 8px;\n  border-color: ${style_1.CssVar.mask.img_fgc};\n  border-top-style: double;\n  border-bottom-style: double;\n  border-left-style: solid;\n  border-right-style: solid;\n  animation: maskSpinCircle 1.2s linear 0s infinite normal;\n}\n.${exports.maskClassName}[data-image="spin-circle"] .${exports.maskClassName}-text {\n  margin-top: 10px;\n}\n@keyframes maskSpinCircle {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n.${exports.maskClassName}[data-image="flow"] .${exports.maskClassName}-item1 {\n  height: 10px;\n  width: 50%;\n  max-width: 80%;\n  min-width: 10%;\n  border-radius: 5px;\n  overflow: hidden;\n  background: ${style_1.CssVar.mask.img_bgc};\n}\n.${exports.maskClassName}[data-image="flow"] .${exports.maskClassName}-item1::before {\n  height: 100%;\n  width: 20%;\n  animation: maskFlow 2s linear 0s infinite normal;\n  border-radius: 5px;\n  background-color: ${style_1.CssVar.mask.img_fgc};\n}\n.${exports.maskClassName}[data-image="flow"] .${exports.maskClassName}-text {\n  margin-top: 10px;\n}\n@keyframes maskFlow {\n  0% {\n    left: -20%;\n  }\n  100% {\n    left: 120%;\n  }\n}\n${"neumorphism"===e?`\n.${exports.maskClassName}[data-image="flow"] .${exports.maskClassName}-item1 {\n  box-shadow: ${style_1.CssParam.n.ccvSd};\n  background: ${style_1.CssParam.n.ccvBg};\n  opacity: 0.9;\n}\n.${exports.maskClassName}[data-image="flow"] .${exports.maskClassName}-item1::before {\n  box-shadow: ${style_1.CssParam.n.cvxSd};\n}\n`:""}\n`});const useMask=e=>{const t=(0,react_1.useRef)(!1),a=(0,react_1.useRef)(),s=(0,react_1.useRef)(!1),r=(0,style_1.useLayout)(),n=(0,react_1.useCallback)((()=>{if(s.current)if(null!=a.current)try{react_dom_1.default.unmountComponentAtNode(a.current),s.current=!1}catch(e){console.log(e)}else s.current=!1}),[]),o=(0,react_1.useCallback)(((n,o)=>{t.current?(null==a.current&&(a.current=document.createElement("div"),document.body.appendChild(a.current)),react_dom_1.default.render(react_1.default.createElement(style_1.StyleContext.Provider,{value:r},react_1.default.createElement(exports.Mask,{...e?.maskProps,...n})),a.current,(()=>{o?.()})),s.current=!0):s.current=!0}),[]);return(0,react_1.useEffect)((()=>{if(e?.accessor)return a.current=e?.accessor?._fetchMask?.()??a.current,s.current&&o(),()=>{if(s.current)try{react_dom_1.default.unmountComponentAtNode(a.current),s.current=!1}catch(e){console.log(e)}}}),[e?.accessor]),(0,react_1.useEffect)((()=>(a.current=e?.accessor?._fetchMask?.()??document.querySelector(`div[data-role="${exports.maskClassName}"][data-name="${e?.name??"_"}"]`),t.current=!0,(!0===e?.showAtFirst||s.current)&&o(),null==a.current?()=>{a.current&&(react_dom_1.default.unmountComponentAtNode(a.current),a.current.parentElement?.removeChild(a.current),a.current=null)}:()=>{if(null!=a.current&&s.current)try{react_dom_1.default.unmountComponentAtNode(a.current)}catch(e){console.log(e)}})),[]),{show:o,close:n}};exports.default=useMask;