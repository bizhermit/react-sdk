"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,s,t,a){void 0===a&&(a=t),Object.defineProperty(e,a,{enumerable:!0,get:function(){return s[t]}})}:function(e,s,t,a){void 0===a&&(a=t),e[a]=s[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,s){Object.defineProperty(e,"default",{enumerable:!0,value:s})}:function(e,s){e.default=s}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var s={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&__createBinding(s,e,t);return __setModuleDefault(s,e),s},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuStyle=exports.menuClassName=void 0;const react_1=__importStar(require("react")),icon_1=__importDefault(require("../graphics/icon")),controller_1=require("../hooks/controller"),style_1=__importStar(require("../layouts/style")),classname_utils_1=require("../utils/classname-utils");exports.menuClassName="bh-menu";const MenuList=e=>{const s=(0,react_1.useRef)(),t=(s,a,n)=>{if(null==s)return null;const r=[];let l=0,o=!1;for(const m of s){if(null==m)continue;const s=t(m.childItems,a+1,n),i=(s?.nodes?.length??0)>0;let d=!0===n?.(m);o=o||d,r.push(react_1.default.createElement(MenuItem,{key:l++,props:m,addProps:{nestLevel:a,selected:d,hasChild:i,childNodes:s?.nodes,showChildren:!0===s?.hasSelected&&!1!==e.openChildren,clicked:e.clicked,width:e.width}}))}return{nodes:r,hasSelected:o}},a=(0,react_1.useMemo)((()=>t(e.items,0,e.selected).nodes),[e.items]);return(0,controller_1.initController)(e.controller,(e=>{e.focus=()=>(s.current?.querySelector("div[tabindex]")?.focus(),e)})),react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{ref:s,style:e.style,className:(0,classname_utils_1.className)(`${exports.menuClassName}-list ${style_1.scrollbarClassName}`,e.className),"data-dirc":e.direction??"vertical","data-reverse":!0===e.reverse},a),exports.MenuStyle)};exports.default=MenuList;const MenuItem=({props:e,addProps:s})=>{const[t,a]=(0,react_1.useState)(s.showChildren||null!=e.childItems&&s.selected),n=t=>{if(s.hasChild){const n=e.clicked?.(e);if(!1!==n){const e=t.nextElementSibling;if(e){"none"===e.style.display?(e?.style.removeProperty("display"),a(!0)):(e.style.display="none",a(!1))}}return void s.clicked?.(e,n)}const n=e.clicked?.(e);s.clicked?.(e,n)};return null==e.label?react_1.default.createElement("div",{className:`${exports.menuClassName}-hr`}):react_1.default.createElement("div",{className:`${exports.menuClassName}-item-wrap`,"data-nest":s.nestLevel},react_1.default.createElement("div",{className:(0,classname_utils_1.className)(`${exports.menuClassName}-item`,s.selected?" bh-selected":""),"data-opened":t,"data-click":null!=e.clicked||null!=e.childItems,onClick:e=>{n(e.currentTarget)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||n(e.currentTarget)},style:{width:s.width},tabIndex:0},null==e.iconImage?react_1.default.createElement(react_1.default.Fragment,null):react_1.default.createElement("div",{className:`${exports.menuClassName}-item-icon`},react_1.default.createElement(icon_1.default,{image:e.iconImage})),react_1.default.createElement("div",{className:`${exports.menuClassName}-item-label`},e.label),s.hasChild?react_1.default.createElement("div",{className:`${exports.menuClassName}-item-icon`},s.hasChild?react_1.default.createElement(icon_1.default,{image:t?"pullup":"pulldown"}):react_1.default.createElement(react_1.default.Fragment,null)):react_1.default.createElement(react_1.default.Fragment,null)),s.hasChild?react_1.default.createElement("div",{className:`${exports.menuClassName}-children ${style_1.scrollbarClassName}`,style:{display:t?null:"none"}},s.childNodes):react_1.default.createElement(react_1.default.Fragment,null))};exports.MenuStyle=react_1.default.createElement(style_1.default,{id:exports.menuClassName,notDepsColor:!0,css:({design:e})=>`\n.${exports.menuClassName}-list,\n.${exports.menuClassName}-item-wrap,\n.${exports.menuClassName}-children {\n  box-sizing: border-box;\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: flex-start;\n  align-items: stretch;\n}\n.${exports.menuClassName}-list {\n  ${style_1.CssPV.fill}\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"] {\n  flex-flow: row nowrap;\n  max-height: 100%;\n  overflow: visible;\n}\n.${exports.menuClassName}-hr {\n  box-sizing: border-box;\n  padding: 0px;\n  border: none;\n  height: 1px;\n  width: 100%;\n  border-top: 1px solid ${style_1.CssVar.bdc};\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"] > .${exports.menuClassName}-hr {\n  width: 1px;\n  height: 100%;\n  border-top: none;\n  border-left: 1px solid ${style_1.CssVar.bdc};\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"] > .${exports.menuClassName}-item-wrap {\n  flex: 1;\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"] > .${exports.menuClassName}-item-wrap > .${exports.menuClassName}-children {\n  background: ${style_1.CssVar.bg.c};\n  max-height: 500%;\n}\n.${exports.menuClassName}-list[data-reverse="true"] .bh-menu-item-wrap {\n  flex-direction: column-reverse;\n}\n.${exports.menuClassName}-item {\n  ${style_1.CssPV.flex_r}\n  flex: none;\n  height: ${style_1.CssVar.size};\n  overflow: hidden;\n  user-select: none;\n  z-index: 1;\n}\n.${exports.menuClassName}-item[data-click="true"] {\n  cursor: pointer;\n}\n.${exports.menuClassName}-item-icon {\n  height: ${style_1.CssVar.size};\n  width: ${style_1.CssVar.size};\n  flex: none;\n}\n.${exports.menuClassName}-item-label {\n  box-sizing: border-box;\n  position: relative;\n  flex: 1;\n  padding: 2px 10px 0px 10px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.${exports.menuClassName}-item-label + .${exports.menuClassName}-item-icon {\n  margin-right: 2px;\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"] .${exports.menuClassName}-item-label {\n  text-align: center;\n}\n.${exports.menuClassName}-children {\n  z-index: 0;\n}\n${"material"===e?`\n.${exports.menuClassName}-item {\n  border-radius: ${style_1.CssParam.m.r};\n  margin: ${style_1.CssParam.m.sdPdd};\n  border: 1px solid transparent;\n}\n.${exports.menuClassName}-item:not([data-click="false"]):hover {\n  border-color: ${style_1.CssVar.bdc};\n  box-shadow: ${style_1.CssParam.m.sdBtm_f};\n  margin-top: calc(${style_1.CssParam.m.sdPdd} - ${style_1.CssParam.m.updownMargin});\n  margin-bottom: calc(${style_1.CssParam.m.sdPdd} + ${style_1.CssParam.m.updownMargin});\n  background: ${style_1.CssVar.bg.c};\n}\n.${exports.menuClassName}-item:not([data-click="false"]):hover:active {\n  box-shadow: none;\n  margin-top: calc(${style_1.CssParam.m.sdPdd} + ${style_1.CssParam.m.updownMargin});\n  margin-bottom: calc(${style_1.CssParam.m.sdPdd} - ${style_1.CssParam.m.updownMargin});\n}\n.${exports.menuClassName}-item.bh-selected {\n  background: ${style_1.CssVar.bg.c_a} !important;\n  margin: ${style_1.CssParam.m.sdPdd} !important;\n  border-color: transparent !important;\n  box-shadow: none !important;\n  cursor: unset !important;  \n}\n.${exports.menuClassName}-item[data-opened="true"] > .${exports.menuClassName}-item-label::before,\n.${exports.menuClassName}-item[data-click="false"] > .${exports.menuClassName}-item-label::before {\n  box-sizing: border-box;\n  position: absolute;\n  content: "";\n  height: 0px;\n  width: 100%;\n  bottom: 0px;\n  left: 0px;\n  border-top: 1px solid ${style_1.CssVar.bdc};\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"] > .${exports.menuClassName}-item-wrap > .${exports.menuClassName}-children {\n  box-shadow: ${style_1.CssParam.m.sdBtm_f};\n  border-radius: 0px 0px ${style_1.CssParam.m.r} ${style_1.CssParam.m.r};\n  margin-bottom: ${style_1.CssParam.m.sdPdd};\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"][data-reverse="true"] > .${exports.menuClassName}-item-wrap > .${exports.menuClassName}-children {\n  border-radius: ${style_1.CssParam.m.r} ${style_1.CssParam.m.r} 0px 0px;\n  margin-bottom: 0px;\n  margin-top: ${style_1.CssParam.m.sdPdd};\n  box-shadow: ${style_1.CssParam.m.sdTop};\n}\n`:""}\n${"neumorphism"===e?`\n.${exports.menuClassName}-item {\n  border-radius: ${style_1.CssParam.n.r};\n  margin: ${style_1.CssParam.n.sdPdd};\n}\n.${exports.menuClassName}-item:not([data-click="false"]):hover {\n  box-shadow: ${style_1.CssParam.n.cvxSd};\n  background: ${style_1.CssParam.n.cvxBg};\n}\n.${exports.menuClassName}-item:not([data-click="false"]):hover:active {\n  box-shadow: ${style_1.CssParam.n.ccvSd};\n  background: ${style_1.CssParam.n.ccvBg};\n}\n.${exports.menuClassName}-item:not([data-click="false"]):hover:active,\n.${exports.menuClassName}-item.bh-selected {\n  padding-top: 1.5px;\n}\n.${exports.menuClassName}-item.bh-selected[data-click] {\n  background: ${style_1.CssParam.n.accent.cvxBg} !important;\n  box-shadow: ${style_1.CssParam.n.ccvSd} !important;\n  cursor: unset !important;\n}\n.${exports.menuClassName}-item[data-opened="true"],\n.${exports.menuClassName}-item[data-click="false"] {\n  box-shadow: ${style_1.CssParam.n.border.cvxSd};\n  background: ${style_1.CssParam.n.cvxBg};\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"] > .${exports.menuClassName}-item-wrap > .${exports.menuClassName}-children {\n  box-shadow: ${style_1.CssParam.n.cvxSd_f};\n  background: ${style_1.CssParam.n.cvxBg};\n  border-radius: 0px 0px ${style_1.CssParam.n.r} ${style_1.CssParam.n.r};\n  margin-bottom: ${style_1.CssParam.n.sdPdd};\n}\n.${exports.menuClassName}-list[data-dirc="horizontal"][data-reverse="true"] > .${exports.menuClassName}-item-wrap > .${exports.menuClassName}-children {\n  border-radius: ${style_1.CssParam.n.r} ${style_1.CssParam.n.r} 0px 0px;\n  margin-bottom: 0px;\n  margin-top: ${style_1.CssParam.n.sdPdd};\n  box-shadow: ${style_1.CssParam.n.border.cvxSd};\n}\n`:""}\n`});