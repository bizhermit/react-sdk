"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,s,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return s[t]}})}:function(e,s,t,r){void 0===r&&(r=t),e[r]=s[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,s){Object.defineProperty(e,"default",{enumerable:!0,value:s})}:function(e,s){e.default=s}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var s={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&__createBinding(s,e,t);return __setModuleDefault(s,e),s},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SliderStyle=exports.sliderClassName=void 0;const react_1=__importStar(require("react")),controller_1=require("../hooks/controller"),value_1=__importDefault(require("../hooks/value")),input_1=__importStar(require("../layouts/input")),style_1=__importStar(require("../layouts/style")),classname_utils_1=require("../utils/classname-utils"),dom_utils_1=require("../utils/dom-utils");exports.sliderClassName="bh-sld";const Slider=e=>{const s=(0,react_1.useRef)(),t=(0,react_1.useRef)(),r=(0,react_1.useRef)(),a=(0,react_1.useRef)(),n=(0,react_1.useRef)(e.min??0),l=(0,react_1.useRef)(e.max??100),i=(0,react_1.useRef)(e.keydownInterval??1),o=(0,react_1.useCallback)((e=>{if(null==r.current)return;const s=e??n.current;r.current.textContent=String(s);const i=(s-n.current)/(l.current-n.current);a.current.style.width=Math.round(100*i)+"%",r.current.style.left=(t.current.clientWidth-r.current.offsetWidth)*i+"px"}),[]),{getValue:d,setValue:c}=(0,value_1.default)(e,{changed:e=>o(e),binded:e=>o(e)});return(0,controller_1.initController)(e.controller,(e=>{e.focus=()=>(s.current?.focus(),e),e.blur=()=>(s.current?.blur(),e),e.getValue=()=>d(),e.setValue=s=>(c(s),e)})),(0,react_1.useEffect)((()=>{if(!0===e.flexibleWidth){const e=new ResizeObserver((()=>{o(d()??n.current)}));return e.observe(s.current),()=>{e&&e.disconnect()}}}),[]),react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{ref:s,style:e.style,className:(0,classname_utils_1.className)(input_1.InputClassNames.wrap,exports.sliderClassName,e.className),"data-disabled":!0===e.disabled,title:e.title,tabIndex:!0===e.disabled?-1:e.tabIndex??0,onKeyDown:s=>{if(!0!==e.disabled)switch(s.key){case"ArrowLeft":s.ctrlKey?c(n.current):c(Math.max(n.current,(d()??n.current)-i.current));break;case"ArrowRight":s.ctrlKey?c(l.current):c(Math.min(l.current,(d()??n.current)+i.current))}},onFocus:()=>e.focus?.(d()),onBlur:()=>e.blur?.(d())},react_1.default.createElement("div",{ref:t,className:`${exports.sliderClassName}-main`},react_1.default.createElement("div",{className:`${exports.sliderClassName}-bar`},react_1.default.createElement("div",{ref:a,className:`${exports.sliderClassName}-rate`})),react_1.default.createElement("div",{ref:r,className:`${exports.sliderClassName}-handle`,onMouseDown:s=>{if(!0===e.disabled)return;const r=s.currentTarget,a=t.current.clientWidth-r.offsetWidth;let i=r.offsetLeft,o=s.clientX;(0,dom_utils_1.setCursor)("col-resize");const d=e=>{c(Math.round(n.current+(l.current-n.current)*(Math.min(Math.max(0,e.clientX-o+i),a)/a)))},u=()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",u),(0,dom_utils_1.releaseCursor)()};window.addEventListener("mouseup",u),window.addEventListener("mousemove",d)}}))),input_1.default,exports.SliderStyle)};exports.default=Slider,exports.SliderStyle=react_1.default.createElement(style_1.default,{id:exports.sliderClassName,notDepsColor:!0,css:({design:e})=>`\n.${exports.sliderClassName} {\n  overflow: hidden;\n  width: 200px;\n}\n.${exports.sliderClassName}-main {\n  box-sizing: border-box;\n  position: relative;\n  overflow: visible;\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: stretch;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n}\n.${exports.sliderClassName}-bar {\n  box-sizing: border-box;\n  position: relative;\n  width: 100%;\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: flex-start;\n  align-items: center;\n  overflow: hidden;\n}\n.${exports.sliderClassName}-rate {\n  box-sizing: border-box;\n  position: relative;\n  height: 100%;\n  min-width: 0%;\n  max-width: 100%;\n}\n.${exports.sliderClassName}-handle {\n  box-sizing: border-box;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  height: ${style_1.CssVar.size};\n  width: ${style_1.CssVar.size};\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: center;\n  align-items: center;\n  user-select: none;\n  padding-top: 1px;\n  font-size: 80%;\n  overflow: visible;\n}\n.${exports.sliderClassName}[data-disabled="false"] .${exports.sliderClassName}-handle {\n  cursor: col-resize;\n}\n${"material"===e?`\n.${exports.sliderClassName}-bar {\n  height: 8px;\n  border-radius: 5px;\n  border: 1px solid ${style_1.CssVar.bdc};\n}\n.${exports.sliderClassName}-handle {\n  border: 1px solid ${style_1.CssVar.bdc};\n  height: calc(${style_1.CssVar.size} - 2px);\n  width: calc(${style_1.CssVar.size} - 2px);\n  background: ${style_1.CssVar.bg.c};\n  border-radius: 50%;\n  top: calc(50% - ${style_1.CssVar.size} / 2);\n}\n.${exports.sliderClassName}[data-disabled="false"] .${exports.sliderClassName}-handle:hover,\n.${exports.sliderClassName}[data-disabled="false"] .${exports.sliderClassName}-handle:active {\n  top: calc(50% - ${style_1.CssVar.size} / 2 - 1px);\n  box-shadow: ${style_1.CssParam.m.sdBtm_f};\n}\n.${exports.sliderClassName}-rate {\n  background: ${style_1.CssVar.slider.bar_c};\n}\n`:""}\n${"neumorphism"===e?`\n.${exports.sliderClassName} {\n  padding: ${style_1.CssParam.n.sdPdd};\n}\n.${exports.sliderClassName}-bar {\n  height: ${style_1.CssVar.size};\n  background: ${style_1.CssParam.n.ccvBg};\n  box-shadow: ${style_1.CssParam.n.ccvSd};\n  border-radius: calc((${style_1.CssVar.size} - ${style_1.CssParam.n.sdPdd} / 2) / 2);\n}\n.${exports.sliderClassName}-handle {\n  height: calc(${style_1.CssVar.size} - ${style_1.CssParam.n.sdPdd} / 2);\n  width: calc(${style_1.CssVar.size} - ${style_1.CssParam.n.sdPdd} / 2);\n  top: calc(50% - (${style_1.CssVar.size} - ${style_1.CssParam.n.sdPdd} / 2) / 2);\n  border-radius: 50%;\n  background: ${style_1.CssParam.n.cvxBg};\n  box-shadow: ${style_1.CssParam.n.cvxSd};\n}\n.${exports.sliderClassName}[data-disabled="true"] .${exports.sliderClassName}-handle {\n  background: transparent;\n  box-shadow: none;\n}\n.${exports.sliderClassName}-rate {\n  background: linear-gradient(to bottom right, ${style_1.CssVar.slider.bar_dc}, ${style_1.CssVar.slider.bar_bc});\n  margin-top: ${style_1.CssParam.n.sdPdd};\n  margin-bottom: ${style_1.CssParam.n.sdPdd};\n  opacity: 0.5;\n}\n`:""}\n`});